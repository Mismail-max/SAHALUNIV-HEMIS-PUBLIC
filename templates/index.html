<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hemis Sahal University</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body class="bg-light">

<div class="container mt-5">

  <!-- Logo & Title -->
  <div class="text-center text-primary mb-4">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="img-fluid rounded-circle" style="width: 130px; height: 130px;">
    <h1 class="mt-3 fw-bold">Sahal University</h1>
  </div>

  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show mt-3" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- Only Show Buttons If Logged In -->
  {% if session.get('username') %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <p class="mb-0 text-secondary fw-semibold">Welcome, {{ session.get('username') }}</p>
    <div class="d-flex gap-2">
      <a href="/students" class="btn btn-outline-info btn-sm">ğŸ“‹ View Students</a>
      <a href="/update_creds" class="btn btn-outline-warning btn-sm">Change Password</a>
      <a href="/register" class="btn btn-outline-success btn-sm">â• Register User</a>
      <a href="/logout" class="btn btn-outline-danger btn-sm">Logout</a>
    </div>
  </div>
  {% endif %}
  
<!-- Search Form -->

  
  <div class="card shadow-lg rounded-4 p-4 border-start border-5 search-card">
    <h6 class="mb-3 text-center text-primary">ğŸ”  Get your Hemis ID, Search by Student ID</h6>
    <form method="POST">
      <div class="d-flex justify-content-center align-items-center" style="max-width: 1000px; width: 100%;">
        <input type="text" id="student_id" name="student_id" class="form-control me-2" style="max-width: 500px;" placeholder="Enter Student ID" required>
        <button type="submit" class="btn btn-primary">Search</button>
      </div>

    </form>
  </div>
  {% if not session.get('username') %}
    <div class="alert alert-success mt-4 p-4 rounded-4 shadow-sm border-start border-5">
      <h4 class="fw-bold text-success mb-3">ğŸ“¢ Wargalin Muhiim ah!</h4>
      <p class="mb-2">
        Muhiim, dhamaan <strong>qalinjabiyaasha</strong> iyo <strong>ardayda dhigata Jaamacada Sahal (SU)</strong>, 
        waxaa lagu wargelinayaa in ay halkan ka hubiyaan HEMIS ID-yadooda.
      </p>
      <p class="mb-2">
        <strong>F.G:</strong> Hadii aad a waydo xogtaada HEMISKA, fadlan degdeg u la xiriir 
        <em>xafiiska diiwaangeliyaha</em> sida ugu dhaqsiyaha badan.
      </p>
      <p class="mb-0 text-end text-muted fst-italic">Mahadsanidiin.</p>
    </div>
  {% endif %}


  {% if message %}
  <div class="alert alert-danger mt-3 rounded-3" role="alert">
    {{ message }}
  </div>
  {% endif %}

  <!-- Search Results -->
  {% if search_results %}
  <div class="card shadow-lg rounded-4 p-4 mt-4 animated-card">
    <h5 class="fw-bold mb-3 text-primary">ğŸ” Search Result</h5>
    <div class="table-responsive">
      <table class="table table-hover table-bordered align-middle text-center">
        <thead class="table-info">
          <tr>
            <th>Hemis RegNumber</th>
            <th>Student ID</th>
            <th>Name</th>
            <th>Academic Year</th>
            <th>Status</th>
            <th>Semester</th>
          </tr>
        </thead>
        <tbody>
          {% for row in search_results %}
          <tr>
            <td>{{ row.hemis_reg_number }}</td>
            <td>{{ row.student_id }}</td>
            <td>{{ row.name }}</td>
            <td>{{ row.academic_year }}</td>
            <td>{{ row.status }}</td>
            <td>{{ row.semester }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <!-- Upload Form (Only if Logged In) -->
  {% if session.get('username') %}
  <div class="card shadow-lg rounded-4 p-4 mt-5 upload-card">
    <h5 class="fw-bold mb-3">ğŸ“‚ Upload Student Data (CSV)</h5>
    <form action="/upload" method="post" enctype="multipart/form-data">
      <div class="row g-3">
        <div class="col-md-10">
          <input type="file" class="form-control border-success" name="file" accept=".csv" required>
        </div>
        <div class="col-md-2 text-end">
          <button type="submit" class="btn btn-success w-100">Upload</button>
        </div>
      </div>
    </form>
  </div>
  {% endif %}

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
